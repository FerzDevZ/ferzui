// ferzui Design System - Advanced Components
// Modern, accessible components with multiple variants

// =============================================================================
// TABS VARIANTS
// =============================================================================

.tabs {
  display: flex;
  border-bottom: 1px solid theme-color('border');
  margin-bottom: spacing(6);
  position: relative;
}

// Default tabs (underline)
.tabs-underline {
  .tab {
    display: inline-flex;
    align-items: center;
    padding: spacing(3) spacing(4);
    border-bottom: 2px solid transparent;
    color: theme-color('text-muted');
    cursor: pointer;
    font-weight: font-weight('medium');
    border-radius: border-radius('md') border-radius('md') 0 0;
    transition: all transition('base');
    position: relative;
    text-decoration: none;
    
    &:hover {
      color: theme-color('text');
      background: theme-color('surface');
    }
    
    &.active {
      color: theme-color('primary');
      border-color: theme-color('primary');
      background: rgba(theme-color('primary'), 0.05);
    }
    
    &:focus-visible {
      @include focus-ring;
    }
  }
}

// Pilled tabs
.tabs-pilled {
  border-bottom: none;
  background: theme-color('muted');
  border-radius: border-radius('full');
  padding: spacing(1);
  gap: spacing(1);
  
  .tab {
    display: inline-flex;
    align-items: center;
    padding: spacing(2) spacing(4);
    border-radius: border-radius('full');
    color: theme-color('text-muted');
    cursor: pointer;
    font-weight: font-weight('medium');
    transition: all transition('base');
    text-decoration: none;
    position: relative;
    
    &:hover {
      color: theme-color('text');
      background: theme-color('surface');
    }
    
    &.active {
      color: theme-color('primary');
      background: theme-color('surface');
      box-shadow: shadow('sm');
    }
    
    &:focus-visible {
      @include focus-ring;
    }
  }
}

// Card tabs
.tabs-card {
  border-bottom: none;
  gap: spacing(2);
  
  .tab {
    display: inline-flex;
    align-items: center;
    padding: spacing(3) spacing(5);
    border: 1px solid theme-color('border');
    border-radius: border-radius('lg');
    color: theme-color('text-muted');
    cursor: pointer;
    font-weight: font-weight('medium');
    transition: all transition('base');
    text-decoration: none;
    background: theme-color('surface');
    
    &:hover {
      color: theme-color('text');
      border-color: theme-color('border-strong');
      box-shadow: shadow('sm');
    }
    
    &.active {
      color: theme-color('primary');
      border-color: theme-color('primary');
      background: rgba(theme-color('primary'), 0.05);
      box-shadow: shadow('md');
    }
    
    &:focus-visible {
      @include focus-ring;
    }
  }
}

// Tab panels
.tab-panel {
  display: none;
  padding: spacing(6) 0;
  animation: tabFadeIn transition('base');
  
  &.active {
    display: block;
  }
}

@keyframes tabFadeIn {
  from {
    opacity: 0;
    transform: translateY(spacing(2));
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

// =============================================================================
// SEGMENTED CONTROL
// =============================================================================

.segmented-control {
  display: inline-flex;
  background: theme-color('muted');
  border-radius: border-radius('lg');
  padding: spacing(1);
  gap: spacing(1);
  position: relative;
  
  &::before {
    content: '';
    position: absolute;
    top: spacing(1);
    left: spacing(1);
    height: calc(100% - #{spacing(2)});
    background: theme-color('surface');
    border-radius: border-radius('md');
    box-shadow: shadow('sm');
    transition: all transition('base');
    z-index: 1;
  }
  
  .segmented-item {
    position: relative;
    z-index: 2;
    display: inline-flex;
    align-items: center;
    padding: spacing(2) spacing(4);
    border-radius: border-radius('md');
    color: theme-color('text-muted');
    cursor: pointer;
    font-weight: font-weight('medium');
    transition: all transition('base');
    text-decoration: none;
    border: none;
    background: transparent;
    font-size: font-size('sm');
    
    &:hover {
      color: theme-color('text');
    }
    
    &.active {
      color: theme-color('primary');
    }
    
    &:focus-visible {
      @include focus-ring;
    }
  }
  
  // Move indicator to active item
  &.segmented-item-1::before { transform: translateX(0); }
  &.segmented-item-2::before { transform: translateX(100%); }
  &.segmented-item-3::before { transform: translateX(200%); }
  &.segmented-item-4::before { transform: translateX(300%); }
}

// =============================================================================
// COMMAND PALETTE (CTRL+K)
// =============================================================================

.command-palette {
  position: fixed;
  inset: 0;
  display: none;
  align-items: flex-start;
  justify-content: center;
  z-index: z-index('modal');
  padding: spacing(20) spacing(4) spacing(4);
  
  &.show {
    display: flex;
  }
  
  .command-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
  }
  
  .command-dialog {
    position: relative;
    background: theme-color('surface-elevated');
    border: 1px solid theme-color('border');
    border-radius: border-radius('2xl');
    box-shadow: shadow('2xl');
    max-width: 32rem;
    width: 100%;
    max-height: 80vh;
    overflow: hidden;
    transform: scale(0.95);
    transition: transform transition('bounce');
  }
  
  &.show .command-dialog {
    transform: scale(1);
  }
  
  .command-input {
    width: 100%;
    padding: spacing(4) spacing(5);
    border: none;
    background: transparent;
    font-size: font-size('lg');
    font-weight: font-weight('medium');
    color: theme-color('text');
    
    &:focus {
      outline: none;
    }
    
    &::placeholder {
      color: theme-color('text-subtle');
    }
  }
  
  .command-results {
    max-height: 20rem;
    overflow-y: auto;
    border-top: 1px solid theme-color('border');
  }
  
  .command-group {
    padding: spacing(2) 0;
    
    .command-group-title {
      padding: spacing(1) spacing(5);
      font-size: font-size('xs');
      font-weight: font-weight('semibold');
      color: theme-color('text-subtle');
      text-transform: uppercase;
      letter-spacing: letter-spacing('wide');
    }
  }
  
  .command-item {
    display: flex;
    align-items: center;
    gap: spacing(3);
    padding: spacing(2) spacing(5);
    cursor: pointer;
    transition: background transition('fast');
    text-decoration: none;
    color: theme-color('text');
    
    &:hover,
    &.active {
      background: theme-color('surface');
    }
    
    .command-icon {
      width: spacing(5);
      height: spacing(5);
      color: theme-color('text-subtle');
    }
    
    .command-content {
      flex: 1;
      
      .command-title {
        font-weight: font-weight('medium');
        margin-bottom: spacing(0\.5);
      }
      
      .command-description {
        font-size: font-size('sm');
        color: theme-color('text-muted');
      }
    }
    
    .command-shortcut {
      font-size: font-size('xs');
      color: theme-color('text-subtle');
      background: theme-color('muted');
      padding: spacing(1) spacing(2);
      border-radius: border-radius('sm');
    }
  }
  
  .command-empty {
    padding: spacing(8) spacing(5);
    text-align: center;
    color: theme-color('text-muted');
    
    .command-empty-icon {
      width: spacing(12);
      height: spacing(12);
      margin: 0 auto spacing(4);
      color: theme-color('text-subtle');
    }
  }
}

// =============================================================================
// DRAWER/SIDEBAR LAYOUT
// =============================================================================

.drawer {
  position: fixed;
  inset: 0;
  display: none;
  z-index: z-index('modal');
  
  &.show {
    display: block;
  }
  
  .drawer-backdrop {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
  }
  
  .drawer-panel {
    position: absolute;
    top: 0;
    width: 20rem;
    max-width: 90vw;
    height: 100%;
    background: theme-color('surface-elevated');
    border-right: 1px solid theme-color('border');
    box-shadow: shadow('xl');
    transform: translateX(-100%);
    transition: transform transition('base');
    overflow-y: auto;
  }
  
  &.show .drawer-panel {
    transform: translateX(0);
  }
  
  // Right drawer
  &.right {
    .drawer-panel {
      right: 0;
      left: auto;
      border-right: none;
      border-left: 1px solid theme-color('border');
      transform: translateX(100%);
    }
    
    &.show .drawer-panel {
      transform: translateX(0);
    }
  }
  
  // Bottom drawer
  &.bottom {
    .drawer-panel {
      top: auto;
      bottom: 0;
      width: 100%;
      height: 50vh;
      max-height: 80vh;
      border-right: none;
      border-top: 1px solid theme-color('border');
      transform: translateY(100%);
    }
    
    &.show .drawer-panel {
      transform: translateY(0);
    }
  }
}

// Persistent sidebar
.sidebar {
  position: fixed;
  top: 0;
  left: 0;
  width: 16rem;
  height: 100vh;
  background: theme-color('surface-elevated');
  border-right: 1px solid theme-color('border');
  z-index: z-index('fixed');
  transition: transform transition('base');
  overflow-y: auto;
  
  &.collapsed {
    transform: translateX(-100%);
  }
  
  .sidebar-header {
    padding: spacing(4);
    border-bottom: 1px solid theme-color('border');
  }
  
  .sidebar-content {
    padding: spacing(4);
  }
  
  .sidebar-footer {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: spacing(4);
    border-top: 1px solid theme-color('border');
    background: theme-color('surface');
  }
}

// Main content with sidebar
.main-with-sidebar {
  margin-left: 16rem;
  transition: margin-left transition('base');
  
  &.sidebar-collapsed {
    margin-left: 0;
  }
}

// =============================================================================
// BREADCRUMB WITH TRUNCATION
// =============================================================================

.breadcrumb {
  display: flex;
  align-items: center;
  gap: spacing(2);
  color: theme-color('text-muted');
  font-size: font-size('sm');
  margin-bottom: spacing(4);
  
  .breadcrumb-item {
    display: flex;
    align-items: center;
    gap: spacing(2);
    
    &:not(:last-child)::after {
      content: '/';
      color: theme-color('text-subtle');
      opacity: 0.5;
    }
    
    a {
      color: theme-color('text-muted');
      text-decoration: none;
      transition: color transition('fast');
      
      &:hover {
        color: theme-color('text');
      }
    }
    
    &.active {
      color: theme-color('text');
      font-weight: font-weight('medium');
    }
  }
  
  // Truncation for long breadcrumbs
  &.truncated {
    .breadcrumb-item {
      &:not(:first-child):not(:last-child):not(.active) {
        display: none;
      }
      
      &.ellipsis {
        &::before {
          content: '...';
          color: theme-color('text-subtle');
        }
      }
    }
  }
}

// =============================================================================
// RESPONSIVE UTILITIES
// =============================================================================

@each $breakpoint, $value in $breakpoints {
  @if $breakpoint != xs {
    @include media-breakpoint-up($breakpoint) {
      .#{escape-class-name($breakpoint)}\:tabs-underline .tab {
        padding: spacing(3) spacing(4);
      }
      
      .#{escape-class-name($breakpoint)}\:tabs-pilled {
        padding: spacing(1);
        gap: spacing(1);
      }
      
      .#{escape-class-name($breakpoint)}\:tabs-card {
        gap: spacing(2);
        
        .tab {
          padding: spacing(3) spacing(5);
        }
      }
      
      .#{escape-class-name($breakpoint)}\:segmented-control {
        padding: spacing(1);
        gap: spacing(1);
        
        .segmented-item {
          padding: spacing(2) spacing(4);
        }
      }
      
      .#{escape-class-name($breakpoint)}\:command-palette {
        padding: spacing(20) spacing(4) spacing(4);
        
        .command-dialog {
          max-width: 32rem;
        }
      }
      
      .#{escape-class-name($breakpoint)}\:drawer .drawer-panel {
        width: 20rem;
      }
      
      .#{escape-class-name($breakpoint)}\:sidebar {
        width: 16rem;
      }
      
      .#{escape-class-name($breakpoint)}\:main-with-sidebar {
        margin-left: 16rem;
      }
    }
  }
}
